<h1> Vulnerability test on Network</h1>

 

<h2>Introduction/Description</h2>
This is a simple home lab project where I tested my  network for security vulnerblites and remediated them.
<br />


<h2>Languages and Utilities Used</h2>

- <b> Nessus </b> 
- <b> Mac OS
-  Mac OS Terminal </b>

<h2>Environments Used </h2>

- <b> Mac OS  </b>
- <b> </b> 


<h2>Program walk-through:</h2>

<p align="left">
Nessus scan type & Devices Scanned  : <br/>  


 <img src="https://imgur.com/m47Bvds.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/1dUGOFY.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br /> As shown in the Nessus  windows, you can see two things. In the first window you can see the scan type I performed on the network which was a basic network scan. And in the second window are a list of  all my scanned devices on my network with the vulnerblites . In total it was 6  devices scanned  but to make my analysis easier I removed the devices that showed no security Vulnerblites which left me with one device on the network with security issues. 
<br />

## Vulnerblites ON MAC OS for Microsoft Office Applications :  <br/>
<img src="https://imgur.com/OYGxEbm.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />       
In this window you can see the vulnerblites that are listed for the  Microsoft Office applications. There are  multiple security issues that left applications microsoft office applications wvunerable to attacks such as remote code execution on Microsoft word, Microsoft Excel, Microsoft and Microsoft outlook. Some more vulnerblites include Microsoft excel security bypass vulnerblity, Microsoft word elevation privilage vunerblity and  Microsoft Excel Information Disclosure Vulnerability. After going through each vulnerblity listed I was able to conclude that the the Microsoft office applications should be updated to each current latest version which contains the security patches for word, Excel,power point and outlook. After disccovering this I downloaded updated versisons of each application. 
<br />

 ## Vulnerblites ON MAC OS for Apache web server:  <br/>
<img src="https://imgur.com/zpUELov.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/HCMvaak.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br /> The vulnerblity that is shown in this window pertains to the Apache web server installed on the Mac os. As you can see in the first window all the  possible vulneriblites are listed. To remediate this I downloaded an updated version of the apache web server via terminal.This is shown in the second window. As you can see in the second window. After I installed the latest version I used the httpd -v command to see the version that is currently running on the Mac os. It was still the old version 2.4.56. I then retarted the Mac system for the updated web server to show and when I checked again it showed the most up to date version apache 2.4.58 which is the recommended version from nessus that has the security paches for these vulnerblites. 

<br />

## Virus Total report:  <br/>
<img src="https://i.imgur.com/TalzEiR.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br /> 
As we continue with this investigation we can already see that this is suspicious activity. First the process command line was Obfuscated and Second we found out that execution of the process command line leads the user to URL which allows them to download unknown files. The next step in our investigation is to check and see if the website from the process is malicious or not. I did this with a tool called Virus total. The results would confirm that the website is indeed malicious. It has a score of 11/90. Which shows that 11 security vendors marked this domain as malicous.
<br />

## Incident Report <br/>
<img src="https://imgur.com/3D2toHo.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />After my triage of this event and confirming that this is a malicous act on the network I then created an investigation report. In a real life scenario the report would be sent to the incident response team in my SOC. 
<br />

## Sand box results :  <br/>
<img src="https://imgur.com/xHssB4C.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br /> After completion of my investigation report on the incident. I decided to do some analysis on the Malicous domain. I used a sandbox tool called ANY.RUN. What I learned about this malicous domain is that when you go to this site there are conections to a lot of diffrent ip address that are outside of the united states. With futher investigation with virus total I found out that some of the IP addresses with these connections have been marked as malicous. I was also able to find out with futher investigation that some of the IP address that are not marked as malicous have connections and communcations  with malicous files. Below is one of the malicous files an IP address that resonates from Germany has a connection with. This IP address was also making connections to the same Domain that was investigated in my report. This is one of the few Ip Address that were either marked as malicous or have been reported on virus total as an IP address that has connections and communications with malicous files.
<br /> 


## Sand Box threat Results: 
<img src="https://imgur.com/LxViLQq.png" height="80%" width="80%" alt="Disk Sanitization Steps"/> 

 Towards the end of my analysis I wans't able to find any actual attacks to the system. However I was able to find a lot of suspcious activity that was taking place on the system when a user visits that domain. The only threat alert I found on the sandbox was a potentially bad traffic alert. This also ran the the iexplore.exe process which could of allowed the malicous actor access to potentially do some phsising while a user is on that domain. I would however recomend the incident response team to run a more comprehensive analysis since that is what they specialize in. 
<br />
</p>  


#### Utilizing Computer Incident Handling Guide
<img src="https://imgur.com/5wt02wN.png" height="80%" width="80%" alt="Disk Sanitization Steps"/> 

<h2>NIST INCIDENT CYCLE</h2>

 
 - <b> PREPERATION: In preperation for this lab I had to configure my SIEM TOOL splunk. I also had to make sure that the alert for a obfuscated  process command line was in my list of alerts . Last thing I had to do was ingest this specfic log data to trigger this alert on my splunk. </b> 
- <b> DETECTION/ANALYSIS: The detection portion of this lab was all done through my splunk tool. As soon as the requriments for the alert was met it notifited me immedietaly on my SIEM tool. The analysis portion was done with hands on interaction with the event in splunk. This consisted of me decrypting the obfuscated process with the tool Cyber chef. Some more analysis that I completed during my investigation was scanning the domain obtained from the proccess. As shown in the lab I used virus total to confirm that the Domain is malicous. Other analysis that I conducted Include a deeper investigation of the confirmed malicous domain in the sandbox tool ANY.RUN. </b>
- <b> CONTAINMENT ERADECATION AND RECORVERY: The steps taken for containment,eradecation and recovery all depend on orginizations methods and policys. But a general overview would would Disconecting the computer from the network for containment. For eradecatrion it could start from just running an anti malware and virus program to locate malicous files and remove them to possibly reimaging the computers operating system and installing it all over again depending on how bad the host is infected. </b>
- <b> POST INCIDENT ACTIVITY: In this example sceniario we had a user process an obfuscated command on their host computer that lead to a malicous domain. With Porper investigation we was able to find out information about the malcious activity on the network. All documented information would be shared with all stakeholders within the company were remediation and preventions technquies can implemented on an incident like this or any similer scenarios. In conclusion the post Incident activity would play as an informative lesson on a malicous event like this.   </b>
